{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 39, "column": 0}, "map": {"version":3,"sources":["file://D%3A/h5video_project/src/components/VideoPlayer.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useEffect, useRef, useState } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport type DPlayer from 'dplayer';\r\nimport 'dplayer/dist/DPlayer.min.css';\r\n\r\ninterface VideoPlayerProps {\r\n  initialUrl: string;\r\n  title?: string;\r\n  cover?: string;\r\n  id: string;\r\n}\r\n\r\nexport default function VideoPlayer({ initialUrl, title, id }: VideoPlayerProps) {\r\n  const containerRef = useRef<HTMLDivElement>(null);\r\n  const playerRef = useRef<DPlayer | null>(null);\r\n  const [currentUrl, setCurrentUrl] = useState(initialUrl);\r\n  const router = useRouter();\r\n\r\n  useEffect(() => {\r\n    console.log('Current Video URL:', currentUrl);\r\n    console.log('Video Title:', title);\r\n\r\n    // Fetch episodes related to the current id\r\n    fetch(`/api/videos/${id}/episodes`)\r\n      .then(response => response.json())\r\n      .then(data => {\r\n        console.log('Episodes:', data);\r\n        // You can use this data to update the player or UI\r\n      })\r\n      .catch(error => console.error('Error fetching episodes:', error));\r\n\r\n    // 初始化播放器\r\n    const initializePlayer = () => {\r\n      if (containerRef.current) {\r\n        import('dplayer').then((DPlayerModule) => {\r\n          if (playerRef.current) {\r\n            playerRef.current.destroy(); // 销毁当前播放器实例\r\n          }\r\n          const DPlayer = DPlayerModule.default;\r\n          playerRef.current = new DPlayer({\r\n            container: containerRef.current as HTMLElement,\r\n            video: {\r\n              url: currentUrl,\r\n              type: 'auto',\r\n            },\r\n            title: title,\r\n            theme: '#FADFA3',\r\n            autoplay: false,\r\n            preload: 'auto',\r\n            volume: 0.7,\r\n            playbackSpeed: [0.5, 0.75, 1, 1.25, 1.5, 2],\r\n            hotkey: true,\r\n            logo: '/logo.png',\r\n            subtitle: {\r\n              url: '',\r\n              type: 'webvtt',\r\n              fontSize: '25px',\r\n              bottom: '10%',\r\n              color: '#fff',\r\n            },\r\n          });\r\n        });\r\n      }\r\n    };\r\n\r\n    initializePlayer();\r\n\r\n    return () => {\r\n      if (playerRef.current) {\r\n        playerRef.current.destroy();\r\n        playerRef.current = null;\r\n      }\r\n    };\r\n  }, [currentUrl, title, id]);\r\n\r\n  const handleEpisodeChange = (newEp: string) => {\r\n    // 更新 URL，假设 id 不变，只更新 ep\r\n    router.push(`/${id}/${newEp}`);\r\n  };\r\n\r\n  return (\r\n    <div className=\"w-screen h-screen\">\r\n      <div ref={containerRef} className=\"w-full h-full\"></div>\r\n      <button onClick={() => handleEpisodeChange('2')}>切换到第二集</button>\r\n    </div>\r\n  );\r\n} "],"names":[],"mappings":";;;;AAEA;AACA;AAHA;;;;;AAce,SAAS,YAAY,EAAE,UAAU,EAAE,KAAK,EAAE,EAAE,EAAoB;IAC7E,MAAM,eAAe,CAAA,GAAA,qMAAA,CAAA,SAAM,AAAD,EAAkB;IAC5C,MAAM,YAAY,CAAA,GAAA,qMAAA,CAAA,SAAM,AAAD,EAAkB;IACzC,MAAM,CAAC,YAAY,cAAc,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAC7C,MAAM,SAAS,CAAA,GAAA,kIAAA,CAAA,YAAS,AAAD;IAEvB,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,QAAQ,GAAG,CAAC,sBAAsB;QAClC,QAAQ,GAAG,CAAC,gBAAgB;QAE5B,2CAA2C;QAC3C,MAAM,CAAC,YAAY,EAAE,GAAG,SAAS,CAAC,EAC/B,IAAI,CAAC,CAAA,WAAY,SAAS,IAAI,IAC9B,IAAI,CAAC,CAAA;YACJ,QAAQ,GAAG,CAAC,aAAa;QACzB,mDAAmD;QACrD,GACC,KAAK,CAAC,CAAA,QAAS,QAAQ,KAAK,CAAC,4BAA4B;QAE5D,SAAS;QACT,MAAM,mBAAmB;YACvB,IAAI,aAAa,OAAO,EAAE;gBACxB,4IAAkB,IAAI,CAAC,CAAC;oBACtB,IAAI,UAAU,OAAO,EAAE;wBACrB,UAAU,OAAO,CAAC,OAAO,IAAI,YAAY;oBAC3C;oBACA,MAAM,UAAU,cAAc,OAAO;oBACrC,UAAU,OAAO,GAAG,IAAI,QAAQ;wBAC9B,WAAW,aAAa,OAAO;wBAC/B,OAAO;4BACL,KAAK;4BACL,MAAM;wBACR;wBACA,OAAO;wBACP,OAAO;wBACP,UAAU;wBACV,SAAS;wBACT,QAAQ;wBACR,eAAe;4BAAC;4BAAK;4BAAM;4BAAG;4BAAM;4BAAK;yBAAE;wBAC3C,QAAQ;wBACR,MAAM;wBACN,UAAU;4BACR,KAAK;4BACL,MAAM;4BACN,UAAU;4BACV,QAAQ;4BACR,OAAO;wBACT;oBACF;gBACF;YACF;QACF;QAEA;QAEA,OAAO;YACL,IAAI,UAAU,OAAO,EAAE;gBACrB,UAAU,OAAO,CAAC,OAAO;gBACzB,UAAU,OAAO,GAAG;YACtB;QACF;IACF,GAAG;QAAC;QAAY;QAAO;KAAG;IAE1B,MAAM,sBAAsB,CAAC;QAC3B,yBAAyB;QACzB,OAAO,IAAI,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,EAAE,OAAO;IAC/B;IAEA,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAI,KAAK;gBAAc,WAAU;;;;;;0BAClC,8OAAC;gBAAO,SAAS,IAAM,oBAAoB;0BAAM;;;;;;;;;;;;AAGvD","debugId":null}},
    {"offset": {"line": 151, "column": 0}, "map": {"version":3,"sources":["file://D%3A/h5video_project/src/components/UserAvatar.tsx"],"sourcesContent":["'use client';\r\n\r\nimport Image from 'next/image';\r\nimport { useState } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\n\r\nexport default function UserAvatar() {\r\n  const router = useRouter();\r\n  const [isLoggedIn] = useState(false);\r\n  const [showDropdown, setShowDropdown] = useState(false);\r\n\r\n  const handleClick = () => {\r\n    if (isLoggedIn) {\r\n      router.push('/user');\r\n    } else {\r\n      router.push('/login');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"fixed top-4 right-4 z-[9999]\">\r\n      <div \r\n        className=\"relative w-10 h-10 rounded-full overflow-hidden border-2 border-white shadow-lg cursor-pointer\"\r\n        onClick={handleClick}\r\n        onMouseEnter={() => setShowDropdown(true)}\r\n        onMouseLeave={() => setShowDropdown(false)}\r\n      >\r\n        <Image\r\n          src=\"https://file.psd.cn/p/stock/20221014/ccemnih3yxg.jpg\"\r\n          alt=\"用户头像\"\r\n          fill\r\n          className=\"object-cover\"\r\n        />\r\n      </div>\r\n      {showDropdown && (\r\n        <div className=\"absolute right-0 mt-2 w-48 bg-white/10 backdrop-blur-sm rounded-lg shadow-lg p-2\">\r\n          {isLoggedIn ? (\r\n            <div className=\"text-white\">\r\n              <div className=\"font-medium\">用户名</div>\r\n              <div className=\"text-sm text-gray-300\">点击查看个人信息</div>\r\n            </div>\r\n          ) : (\r\n            <div className=\"text-white\">\r\n              <div className=\"text-sm text-gray-300\">点击登录</div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n} "],"names":[],"mappings":";;;;AAEA;AACA;AACA;AAJA;;;;;AAMe,SAAS;IACtB,MAAM,SAAS,CAAA,GAAA,kIAAA,CAAA,YAAS,AAAD;IACvB,MAAM,CAAC,WAAW,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAC9B,MAAM,CAAC,cAAc,gBAAgB,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAEjD,MAAM,cAAc;QAClB,IAAI,YAAY;YACd,OAAO,IAAI,CAAC;QACd,OAAO;YACL,OAAO,IAAI,CAAC;QACd;IACF;IAEA,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBACC,WAAU;gBACV,SAAS;gBACT,cAAc,IAAM,gBAAgB;gBACpC,cAAc,IAAM,gBAAgB;0BAEpC,cAAA,8OAAC,6HAAA,CAAA,UAAK;oBACJ,KAAI;oBACJ,KAAI;oBACJ,IAAI;oBACJ,WAAU;;;;;;;;;;;YAGb,8BACC,8OAAC;gBAAI,WAAU;0BACZ,2BACC,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAI,WAAU;sCAAc;;;;;;sCAC7B,8OAAC;4BAAI,WAAU;sCAAwB;;;;;;;;;;;yCAGzC,8OAAC;oBAAI,WAAU;8BACb,cAAA,8OAAC;wBAAI,WAAU;kCAAwB;;;;;;;;;;;;;;;;;;;;;;AAOrD","debugId":null}},
    {"offset": {"line": 256, "column": 0}, "map": {"version":3,"sources":["file://D%3A/h5video_project/src/components/EpisodeList.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\n\r\ninterface Episode {\r\n  id: string;\r\n  title: string;\r\n  isLocked: boolean;\r\n}\r\n\r\ninterface EpisodeListProps {\r\n  updateVideoUrl: (url: string) => void;\r\n  id: string;\r\n}\r\n\r\nexport default function EpisodeList({ updateVideoUrl, id }: EpisodeListProps) {\r\n  const router = useRouter();\r\n  const [isExpanded, setIsExpanded] = useState(false);\r\n  const [episodes] = useState<Episode[]>(Array.from({ length: 8 }, (_, i) => ({\r\n    id: (i + 1).toString(),\r\n    title: `第${i + 1}集`,\r\n    isLocked: i >= 3, // 假设前三集是解锁的\r\n  })));\r\n\r\n  const handleEpisodeClick = (episode: Episode) => {\r\n    if (episode.isLocked) {\r\n      router.push(`/payment?episodeId=${episode.id}`);\r\n    } else {\r\n      // 使用 updateVideoUrl 切换到对应剧集\r\n      const newUrl = `/${id}/${episode.id}`;\r\n      updateVideoUrl(newUrl);\r\n      console.log('切换到剧集:', episode.id);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"fixed right-4 top-1/2 -translate-y-1/2 z-[9999]\">\r\n      <button\r\n        onClick={() => setIsExpanded(!isExpanded)}\r\n        className=\"w-10 h-10 rounded-full bg-white/10 backdrop-blur-sm flex items-center justify-center text-white hover:bg-white/20 transition-colors\"\r\n      >\r\n        <svg\r\n          xmlns=\"http://www.w3.org/2000/svg\"\r\n          className=\"h-6 w-6\"\r\n          fill=\"none\"\r\n          viewBox=\"0 0 24 24\"\r\n          stroke=\"currentColor\"\r\n        >\r\n          <path\r\n            strokeLinecap=\"round\"\r\n            strokeLinejoin=\"round\"\r\n            strokeWidth={2}\r\n            d=\"M4 6h16M4 12h16M4 18h16\"\r\n          />\r\n        </svg>\r\n      </button>\r\n\r\n      {isExpanded && (\r\n        <div className=\"absolute right-0 mt-2 w-64 bg-white/10 backdrop-blur-sm rounded-lg shadow-lg p-4 max-h-64 overflow-y-auto\">\r\n          <div className=\"flex justify-between items-center mb-4\">\r\n            <h2 className=\"text-xl font-bold text-white\">选集列表</h2>\r\n            <button\r\n              onClick={() => setIsExpanded(false)}\r\n              className=\"text-white hover:text-gray-300\"\r\n            >\r\n              <svg\r\n                xmlns=\"http://www.w3.org/2000/svg\"\r\n                className=\"h-5 w-5\"\r\n                viewBox=\"0 0 20 20\"\r\n                fill=\"currentColor\"\r\n              >\r\n                <path\r\n                  fillRule=\"evenodd\"\r\n                  d=\"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z\"\r\n                  clipRule=\"evenodd\"\r\n                />\r\n              </svg>\r\n            </button>\r\n          </div>\r\n          <div className=\"grid grid-cols-2 gap-2\">\r\n            {episodes.map((episode) => (\r\n              <button\r\n                key={episode.id}\r\n                onClick={() => handleEpisodeClick(episode)}\r\n                className={`p-2 rounded text-center transition-colors ${\r\n                  episode.isLocked\r\n                    ? 'bg-gray-800 text-gray-400 hover:bg-gray-700'\r\n                    : 'bg-white/10 text-white hover:bg-white/20'\r\n                }`}\r\n              >\r\n                <div className=\"relative\">\r\n                  {episode.title}\r\n                  {episode.isLocked && (\r\n                    <span className=\"absolute -top-1 -right-1 text-xs bg-yellow-500 text-black px-1 rounded\">\r\n                      锁定\r\n                    </span>\r\n                  )}\r\n                </div>\r\n              </button>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n} "],"names":[],"mappings":";;;;AAEA;AACA;AAHA;;;;AAgBe,SAAS,YAAY,EAAE,cAAc,EAAE,EAAE,EAAoB;IAC1E,MAAM,SAAS,CAAA,GAAA,kIAAA,CAAA,YAAS,AAAD;IACvB,MAAM,CAAC,YAAY,cAAc,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAC7C,MAAM,CAAC,SAAS,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAa,MAAM,IAAI,CAAC;QAAE,QAAQ;IAAE,GAAG,CAAC,GAAG,IAAM,CAAC;YAC1E,IAAI,CAAC,IAAI,CAAC,EAAE,QAAQ;YACpB,OAAO,CAAC,CAAC,EAAE,IAAI,EAAE,CAAC,CAAC;YACnB,UAAU,KAAK;QACjB,CAAC;IAED,MAAM,qBAAqB,CAAC;QAC1B,IAAI,QAAQ,QAAQ,EAAE;YACpB,OAAO,IAAI,CAAC,CAAC,mBAAmB,EAAE,QAAQ,EAAE,EAAE;QAChD,OAAO;YACL,4BAA4B;YAC5B,MAAM,SAAS,CAAC,CAAC,EAAE,GAAG,CAAC,EAAE,QAAQ,EAAE,EAAE;YACrC,eAAe;YACf,QAAQ,GAAG,CAAC,UAAU,QAAQ,EAAE;QAClC;IACF;IAEA,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBACC,SAAS,IAAM,cAAc,CAAC;gBAC9B,WAAU;0BAEV,cAAA,8OAAC;oBACC,OAAM;oBACN,WAAU;oBACV,MAAK;oBACL,SAAQ;oBACR,QAAO;8BAEP,cAAA,8OAAC;wBACC,eAAc;wBACd,gBAAe;wBACf,aAAa;wBACb,GAAE;;;;;;;;;;;;;;;;YAKP,4BACC,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAG,WAAU;0CAA+B;;;;;;0CAC7C,8OAAC;gCACC,SAAS,IAAM,cAAc;gCAC7B,WAAU;0CAEV,cAAA,8OAAC;oCACC,OAAM;oCACN,WAAU;oCACV,SAAQ;oCACR,MAAK;8CAEL,cAAA,8OAAC;wCACC,UAAS;wCACT,GAAE;wCACF,UAAS;;;;;;;;;;;;;;;;;;;;;;kCAKjB,8OAAC;wBAAI,WAAU;kCACZ,SAAS,GAAG,CAAC,CAAC,wBACb,8OAAC;gCAEC,SAAS,IAAM,mBAAmB;gCAClC,WAAW,CAAC,0CAA0C,EACpD,QAAQ,QAAQ,GACZ,gDACA,4CACJ;0CAEF,cAAA,8OAAC;oCAAI,WAAU;;wCACZ,QAAQ,KAAK;wCACb,QAAQ,QAAQ,kBACf,8OAAC;4CAAK,WAAU;sDAAyE;;;;;;;;;;;;+BAXxF,QAAQ,EAAE;;;;;;;;;;;;;;;;;;;;;;AAuB/B","debugId":null}},
    {"offset": {"line": 417, "column": 0}, "map": {"version":3,"sources":["file://D%3A/h5video_project/src/app/%5Bid%5D/%5Bep%5D/page.tsx"],"sourcesContent":["'use client';\n\nimport VideoPlayer from '@/components/VideoPlayer';\nimport UserAvatar from '@/components/UserAvatar';\nimport EpisodeList from '@/components/EpisodeList';\nimport { useParams } from 'next/navigation';\nimport { useEffect, useState } from 'react';\n\n// Define the type for video data\ntype VideoData = {\n  title: string;\n  url: string;\n  cover: string;\n};\n\n// Function to fetch video data from the API\nasync function fetchVideoData(id: string, ep: string): Promise<{ title: string; url: string; cover: string }> {\n  try {\n    const response = await fetch(`/api/videos/${id}/episodes/${ep}`);\n    if (!response.ok) {\n      throw new Error('网络响应失败');\n    }\n    const data = await response.json();\n    console.log('Fetched data:', data);\n    return data;\n  } catch (error) {\n    console.error('Error fetching video data:', error);\n    throw error;\n  }\n}\n\n// Main component for the video page\nexport default function VideoPage() {\n  const params = useParams() as { id: string; ep: string }; // 使用类型断言\n\n  const { id, ep } = params; // 解构参数\n\n  console.log('ID:', id, 'EP:', ep); // 添加调试日志\n\n  // State to hold video data\n  const [videoData, setVideoData] = useState<VideoData | null>(null);\n\n  // useEffect to fetch video data when id or ep change\n  useEffect(() => {\n    console.log('useEffect triggered with ID:', id, 'EP:', ep); // 添加调试日志\n    if (id && ep) {\n      fetchVideoData(id, ep).then(data => {\n        console.log('Setting videoData:', data);\n        setVideoData(data);\n      }).catch(error => {\n        console.error('Error setting videoData:', error);\n      });\n    }\n  }, [id, ep]); // 确保依赖项数组中包含 id 和 ep\n\n  // If videoData is not yet available, show loading message\n  if (!videoData) {\n    return <div>加载中...</div>;\n  }\n\n  // Render the video player and other components\n  return (\n    <div className=\"fixed inset-0 bg-black overflow-hidden\">\n      <div className=\"absolute inset-0\">\n        <VideoPlayer\n          initialUrl={videoData.url}\n          title={videoData.title}\n          cover={videoData.cover}\n          id={id}\n        />\n      </div>\n      <UserAvatar />\n      <EpisodeList updateVideoUrl={(url) => console.log('Update video URL:', url)} id={id} />\n      <style jsx>{`\n         .issue-button-class {\n          display: none !important;\n        }\n      `}</style>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AANA;;;;;;;;AAeA,4CAA4C;AAC5C,eAAe,eAAe,EAAU,EAAE,EAAU;IAClD,IAAI;QACF,MAAM,WAAW,MAAM,MAAM,CAAC,YAAY,EAAE,GAAG,UAAU,EAAE,IAAI;QAC/D,IAAI,CAAC,SAAS,EAAE,EAAE;YAChB,MAAM,IAAI,MAAM;QAClB;QACA,MAAM,OAAO,MAAM,SAAS,IAAI;QAChC,QAAQ,GAAG,CAAC,iBAAiB;QAC7B,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,8BAA8B;QAC5C,MAAM;IACR;AACF;AAGe,SAAS;IACtB,MAAM,SAAS,CAAA,GAAA,kIAAA,CAAA,YAAS,AAAD,KAAmC,SAAS;IAEnE,MAAM,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,QAAQ,OAAO;IAElC,QAAQ,GAAG,CAAC,OAAO,IAAI,OAAO,KAAK,SAAS;IAE5C,2BAA2B;IAC3B,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAoB;IAE7D,qDAAqD;IACrD,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,QAAQ,GAAG,CAAC,gCAAgC,IAAI,OAAO,KAAK,SAAS;QACrE,IAAI,MAAM,IAAI;YACZ,eAAe,IAAI,IAAI,IAAI,CAAC,CAAA;gBAC1B,QAAQ,GAAG,CAAC,sBAAsB;gBAClC,aAAa;YACf,GAAG,KAAK,CAAC,CAAA;gBACP,QAAQ,KAAK,CAAC,4BAA4B;YAC5C;QACF;IACF,GAAG;QAAC;QAAI;KAAG,GAAG,qBAAqB;IAEnC,0DAA0D;IAC1D,IAAI,CAAC,WAAW;QACd,qBAAO,8OAAC;sBAAI;;;;;;IACd;IAEA,+CAA+C;IAC/C,qBACE,8OAAC;iDAAc;;0BACb,8OAAC;yDAAc;0BACb,cAAA,8OAAC,iIAAA,CAAA,UAAW;oBACV,YAAY,UAAU,GAAG;oBACzB,OAAO,UAAU,KAAK;oBACtB,OAAO,UAAU,KAAK;oBACtB,IAAI;;;;;;;;;;;0BAGR,8OAAC,gIAAA,CAAA,UAAU;;;;;0BACX,8OAAC,iIAAA,CAAA,UAAW;gBAAC,gBAAgB,CAAC,MAAQ,QAAQ,GAAG,CAAC,qBAAqB;gBAAM,IAAI;;;;;;;;;;;;;;;;AAQvF","debugId":null}}]
}